000100***===>>>                                                         00010000
000200*           XIRZ5058                                              00020000
000300****==>>>                                                         00030000
000400*                                                                 00040000
000500***************************************************************** 00050000
000600* I D E N T I F I C A T I O N   D I V I S I O N                 * 00060000
000700***************************************************************** 00070000
000800*                                                                 00080000
000900 IDENTIFICATION DIVISION.                                         00090000
001000 PROGRAM-ID.    XIRZ5058.                                         00100000
001100 AUTHOR.        REGIONAL INVOICE BILLING.                         00110000
001200 DATE-WRITTEN.  JANUARY 5, 2001.                                  00120000
001300 DATE-COMPILED.                                                   00130000
001400 SECURITY.                                                        00140000
001500 COPY PROP0AA0.                                                   00150000
001600                                                                  00160000
001700***************************************************************** 00170000
001800*           D E S C R I P T I O N  O F  P R O G R A M           * 00180000
001900*                                                               * 00190000
002000* PROGRAM ID:      XIRZ5058                                     * 00200000
002100*                                                               * 00210000
002200* PROGRAM NAME:    "UNIVERSITY BLOCK"                           * 00220000
002300*                                                               * 00230000
002400* FUNCTIONAL AREA: TRANSMISSION ACCEPTANCE                      * 00240000
002500*                                                               * 00250000
002600* PURPOSE:         EDIT RESTRICTED ACCOUNTS.                    * 00260000
002700*                                                               * 00270000
002800* DESCRIPTION:     NEW MEXICO UNIVERSITY ACCOUNT WILL BE BLOCK  * 00280000
002900*                                                               * 00290000
003000*                           *************************           * 00300000
003100*                                                               * 00310000
003200*                  THIS MODULE WILL BE DYNAMICLY  LINKED INTO   * 00320000
003300*                  XIRS1000.                                    * 00330000
003400*                                                                 00340000
003500* FREQUENCY:       ON-DEMAND                                      00350000
003600*                                                                 00360000
003700* INPUT/OUTPUT:                                                   00370000
003800*                                                                 00380000
003900*     LINKAGE                DESCRIPTION                          00390000
004000*   ------------    ------------------------------                00400000
004100*     Z5058LK1      LINKAGE MEMBER(S) DESCRIPTION                 00410000
004200*                                                                 00420000
004300*   PARAMETER                               POSSIBLE              00430000
004400*      CARD           DESCRIPTION            VALUES    REQUIRED   00440000
004500*   ---------   -------------------------   ---------  --------   00450000
004600*     N/A                                                         00460000
004700*                                                               * 00470000
004800*     TABLE    TABLE                                    ACCESS  * 00480000
004900*     VIEW       #            TABLE NAME                 TYPE   * 00490000
005000*   ---------  ------  -----------------------------   -------- * 00500000
005100*    XIRZ056V          XY4APA7T - VALIDATION TABLE       READ   * 00510000
005200*                      COLORADO ACCOUNTING(COACCT)              * 00520000
005300*                                                               * 00530000
005400*    XIRZDATE  DS20.15 XY4DSC1T - SUPPLIER TABLE         READ   * 00540000
005500*                                                               * 00550000
005600*                                                   SORT        * 00560000
005700*   FILE ID            RECORD NAME              SPECIFICATION   * 00570000
005800*   --------   -----------------------------   ---------------- * 00580000
005900*   N/A                                                         * 00590000
006000*                                                               * 00600000
006100*                                                   SORT        * 00610000
006200* ASSOCIATED PROGRAMS:                                          * 00620000
006300*                                                               * 00630000
006400*             PROGRAM ID   PROGRAM NAME                         * 00640000
006500*             ----------   ----------------------------------   * 00650000
006600*  CALLED BY: XIRZ5000     MAIN TRANSACTION EDIT MODULE         * 00660000
006700*                                                               * 00670000
006800*  CALLS:     XIRDAZ58     DATA LAYER LINK                      * 00680000
006900*             XIRZ7200     REMOTE CONNECTION LINKAGE           *  00690000
007000/                                                                 00700000
007100***************************************************************** 00710000
007200***                                                           *** 00720000
007300***        P R O G R A M    H I S T O R Y                     *** 00730000
007400***                                                           *** 00740000
007500***************************************************************** 00750000
007600* RELEASE  TR/MCR                                               * 00760000
007700*    #        #    AUTHOR   DATE    MODIFICATION DESCRIPTION    * 00770000
007800***************************************************************** 00780000
007900* 010315 C000428-01A WXD  01/05/01  INITIAL RELEASE             * 00790000
008000*                                                               * 00800000
008100* R011213  X010627-62 YZHAO 09/12/01 RECOMPILE FOR OS390 & VM   * 00810000
008200*                                    COMPILER                   * 00820000
008300*                                                               * 00830000
008400* R071108  B0611BI088 SPANDIA17/09/07RECOMPILE FOR E81XXXXM     * 00840000
008500*                                    COPYBOOK CHANGES.          * 00850000
008600*                                                               * 00860000
008700* EMER   B4583822   AXKRIS7 15/02/08 CHANGED CODE TO CALL       * 00870000
008800* NEO#   17320                       XIRZ7200 TO CONNECT, RESET * 00880000
008900*                                    AND TO DO  REMOTE ACCESS   * 00890000
009000*                                    ON XIRZ056V.CHANGED CODE   * 00900000
009100*                                    TO DO AN INTERNAL TABLE    * 00910000
009200*                                    SEARCH BY ADDING A NEW    *  00920000
009300*                                    MODULE XIRDAZ58 TO FETCH   * 00930000
009400*                                    APA7 TABLE(XIRZ056Y).      * 00940000
009500*                                                               * 00950000
009600* R080417             SBANERJ 04/17/08 RECOMPILE FOR E81XXXXM   * 00960000
009700* RCBS :B4493226             (MM/DD/YY)COPYBOOK CHANGES.        * 00970000
009800* NEO #:0001121                                                 * 00980000
009900*                                                               * 00990000
010000* R080925    JXMILL9     09/25/08      RECOMPILED THE CODE FOR  * 01000000
010100* NEO 0009407                          E81XXXXM                 * 01010000
010200* RCBS:B4736102                        COPYBOOK CHANGES         * 01020000
010300* VERIZON WIRELESS                                              * 01030000
010400*                                                               * 01040000
010500* R100318    PKCHAND     01/20/10      RECOMPILED THE CODE FOR  * 01050000
010600* RCBS :B5025006        (MM/DD/YY)     E015121M, E015127M AND   * 01060000
010700* NEO #:0015177                        E81XXXXM COPYBOOK CHANGES* 01070000
010800*                                                               * 01080000
010900*                                                               * 01090000
011000* R121115 B5414521   DCOWAN  09/20/12 RECOMPILED FOR Z72000LK1  * 01100000
011100* NEO #   0026192                     CHANGE TO COLLN-ID        * 01110000
011200* WBS # I.954145.E.59                                           * 01120000
011210*                                                               * 01121000
011220* R140814    AKMOHA2     08/14/14      RECOMPILE THE CODE FOR   * 01122000
011230* NEO 7207707          (MM/DD/YY)      E81XXXXM AND EX81XXXX    * 01123000
011240* WBS:                                 COPYBOOK CHANGES         * 01124000
011250*                                                               * 01125000
011260* PR0002414  UCHANDR     15/05/14     RECOMPILED FOR E015121M   * 01126000
011270* CR# 5327                            AND E015127M COPYBOOK     * 01127000
011280*                                     CHANGES FOR REDEFINING    * 01128000
011290*                                     SUM21-IX-CARR-RTRN-CD-3 TO* 01129000
011291*                                     SUM21-ICE-ENA-NULL-INV    * 01129100
011292*                                                               * 01129200
011293* R150820            UCHANDR 08/20/15 R150820 PR0003863 -       * 01129300
011294*                                     COBOL V5.1                * 01129400
011295*                                                               * 01129500
011300***************************************************************** 01130000
011400/                                                                 01140000
011500***************************************************************** 01150000
011600* E N V I R O N M E N T   D I V I S I O N                       * 01160000
011700***************************************************************** 01170000
011800*                                                                 01180000
011900 ENVIRONMENT DIVISION.                                            01190000
012000 CONFIGURATION SECTION.                                           01200000
012100 SOURCE-COMPUTER. IBM-3090.                                       01210000
012200 OBJECT-COMPUTER. IBM-3090.                                       01220000
012300                                                                  01230000
012400 INPUT-OUTPUT SECTION.                                            01240000
012500 FILE-CONTROL.                                                    01250000
012600*                                                                 01260000
012700***************************************************************** 01270000
012800* D A T A    D I V I S I O N                                    * 01280000
012900***************************************************************** 01290000
013000*                                                                 01300000
013100 DATA DIVISION.                                                   01310000
013200 FILE SECTION.                                                    01320000
013300/                                                                 01330000
013400***************************************************************** 01340000
013500* W O R K I N G - S T O R A G E    S E C T I O N                * 01350000
013600***************************************************************** 01360000
013700*                                                                 01370000
013800 WORKING-STORAGE SECTION.                                         01380000
013900 COPY NDVRWKST.                                                   01390000
014000                                                                  01400000
014100***************************************************************** 01410000
014200*                                                               * 01420000
014300*   XIRZ5058 MODULE SPECIFIC WORKING STORAGE                    * 01430000
014400*                                                               * 01440000
014500***************************************************************** 01450000
014600******************************************************************01460000
014700*    P R O G R A M  S A V E  A R E A S                           *01470000
014800******************************************************************01480000
014900 01  EMI-RECORD-AREA                PIC X(220).                   01490000
015000******************************************************************01500000
015100*    E 8 1 X X X X  S A V E  A R E A                             *01510000
015200******************************************************************01520000
015300 01  E81XXXXM REDEFINES EMI-RECORD-AREA.                          01530000
015400 COPY E81XXXXM.                                                   01540000
015500/                                                                 01550000
015600******************************************************************01560000
015700*    E 0 1 0 1 0 1  S A V E  A R E A                             *01570000
015800******************************************************************01580000
015900 01  E015124M REDEFINES EMI-RECORD-AREA.                          01590000
016000 COPY E015124M.                                                   01600000
016100/                                                                 01610000
016200******************************************************************01620000
016300*    E 0 1 0 1 0 1  S A V E  A R E A                             *01630000
016400******************************************************************01640000
016500 01  E010101M REDEFINES EMI-RECORD-AREA.                          01650000
016600 COPY E010101M.                                                   01660000
016700/                                                                 01670000
016800******************************************************************01680000
016900*    P R O G R A M  L I T E R A L S                              *01690000
017000******************************************************************01700000
017100 01  XIRZ5058-WORKING-STORAGE.                                    01710000
017200       10  FILLER                      PIC X(14) VALUE            01720000
017300           '******MODULE '.                                       01730000
017400       10  WS-PROGRAM-NAME-LIT         PIC X(08)                  01740000
017500                                       VALUE 'XIRZ5058'.          01750000
017600       10  FILLER                      PIC X(18) VALUE            01760000
017700           'STARTS HERE!******'.                                  01770000
017800/                                                                 01780000
017900******************************************************************01790000
018000*    P R O G R A M  L I T E R A L S                              *01800000
018100******************************************************************01810000
018200 01  XIRZ5058-LITERALS.                                           01820000
018300        10  WS-0                       PIC 9(01) VALUE 0.         01830000
018400        10  WS-1                       PIC 9(01) VALUE 1.         01840000
018500        10  LT-8                       PIC X(01) VALUE '8'.       01850000
018600        10  LT-WTN                     PIC X(01) VALUE 'A'.       01860000
018700        10  LT-BTN                     PIC X(01) VALUE 'B'.       01870000
018800        10  LT-900                     PIC X(03) VALUE '900'.     01880000
018900        10  LT-ATT                     PIC X(06) VALUE '0288  '.  01890000
019000        10  LT-015127                  PIC X(06) VALUE '015127'.  01900000
019100        10  LT-425001                  PIC X(06) VALUE '425001'.  01910000
019200        10  WS-XIRZ056Y-VIEW           PIC X(08) VALUE 'XIRZ056Y'.01920000
019300        10  LT-XIRZ7200                PIC X(08) VALUE 'XIRZ7200'.01930000
019400        10  LT-XIRDAZ58                PIC X(08) VALUE 'XIRDAZ58'.01940000
019500******************************************************************01950000
019600*    D B 2 / S Q L  C O D E S                                    *01960000
019700******************************************************************01970000
019800 COPY SQLCODES.                                                   01980000
019900******************************************************************01990000
020000*    P R O G R A M  S W I T C H E S  &  F L A G S                *02000000
020100******************************************************************02010000
020200                                                                  02020000
020300 01  XIRZ5058-SWITCHES-AND-FLAGS.                                 02030000
020400    05  WS-FIRST-TIME-CALL-FLG       PIC X(01)  VALUE 'Y'.        02040000
020500         88  FIRST-TIME-CALL                    VALUE 'Y'.        02050000
020600         88  NOT-FIRST-TIME-CALL                VALUE 'N'.        02060000
020700/                                                                 02070000
020800******************************************************************02080000
020900*    P R O G R A M  W O R K  A R E A S                           *02090000
021000******************************************************************02100000
021100 05  XIRZ5058-SAVE-AREA.                                          02110000
021200    10  WS-EDIT-KEY                  PIC X(13)  VALUE ZEROS.      02120000
021300    10  WS-TYPE-CD                    PIC X(01).                  02130000
021400/                                                                 02140000
021500******************************************************************02150000
021600*    A B E N D  C O D E S  A N D  M E S S A G E S                *02160000
021700******************************************************************02170000
021800 05  XIRZ5058-ABEND-CODES.                                        02180000
021900    10  WS-ERROR-CALL-XIRZ7200       PIC X(30) VALUE              02190000
022000         'ERROR DURING CALL OF XIRZ7200'.                         02200000
022100    10  WS-ACCOUNT-BLOCK             PIC  9(04)                   02210000
022200                                         VALUE  1097.             02220000
022300***************************************************************** 02230000
022400* X I R Z 7 2 0 0  REMOTE CONNECT MODULE                        * 02240000
022500***************************************************************** 02250000
022600 01  Z7200LK1.                                                    02260000
022700 COPY Z7200LK1.                                                   02270000
022800 EJECT                                                            02280000
022900                                                                  02290000
023000/                                                                 02300000
023100***************************************************************** 02310000
023200* X I R D A Z 5 8  SUB MODULE                                   * 02320000
023300***************************************************************** 02330000
023400 01  DAZ58LK1.                                                    02340000
023500 COPY DAZ58LK1.                                                   02350000
023600 EJECT                                                            02360000
023700                                                                  02370000
023800/                                                                 02380000
023900***************************************************************** 02390000
024000*                 L I N K A G E   S E C T I O N                 * 02400000
024100***************************************************************** 02410000
024200*                                                                 02420000
024300 LINKAGE SECTION.                                                 02430000
024400 01  Z5058LK1.                                                    02440000
024500 COPY Z5058LK1.                                                   02450000
024600*                                                                 02460000
024700/                                                                 02470000
024800***************************************************************** 02480000
024900* P R O C E D U R E    D I V I S I O N                          * 02490000
025000***************************************************************** 02500000
025100*                                                                 02510000
025200 PROCEDURE DIVISION USING Z5058LK1.                               02520000
025300*                                                                 02530000
025400***************************************************************** 02540000
025500*                 0000 MAINLINE                                 * 02550000
025600*                                                               * 02560000
025700*    THIS IS THE MAIN MODULE IN THE PROGRAM.                    * 02570000
025800*                                                               * 02580000
025900*    PARAGRAPHS CALLED: 1000 START PROCESS                      * 02590000
026000*                       2000 MAIN PROCESS                       * 02600000
026100*                                                               * 02610000
026200***************************************************************** 02620000
026300                                                                  02630000
026400 0000-MAINLINE.                                                   02640000
026500                                                                  02650000
026600     IF FIRST-TIME-CALL                                           02660000
026700        COPY NDVRAUDT.                                            02670000
026800        PERFORM 1000-START-PROCESS                                02680000
026900        PERFORM 2000-MAIN-PROCESS                                 02690000
027000        SET NOT-FIRST-TIME-CALL TO TRUE                           02700000
027100     END-IF                                                       02710000
027200                                                                  02720000
027300     MOVE EDIT-KEY OF Z5058LK1 TO WS-EDIT-KEY.                    02730000
027400     IF VLDTN-TYP-CD OF Z5058LK1 = 'BT'                           02740000
027500         MOVE LT-BTN TO WS-TYPE-CD                                02750000
027600     ELSE                                                         02760000
027700         MOVE LT-WTN TO WS-TYPE-CD                                02770000
027800     END-IF.                                                      02780000
027900        PERFORM 4000-SEARCH-TBL                                   02790000
028000                                                                  02800000
028100     PERFORM Z9000-CHECKOUT.                                      02810000
028200                                                                  02820000
028300/                                                                 02830000
028400***************************************************************** 02840000
028500*                 1000 START PROCESS                            * 02850000
028600*                                                               * 02860000
028700*    THIS PARAGRAPH CONTROLS THE WORKING STORAGE INITIALIZATION.* 02870000
028800*    IT CALLS THE PARAGRAPHS TO SELECT ALL NEEDED DATA FROM     * 02880000
028900*    THE VALIDATION TABLE AND LOADS ALL RETRIEVED ROWS INTO AN  * 02890000
029000*    INTERNAL WORKING STORAGE TABLE.                            * 02900000
029100*                                                               * 02910000
029200*                                                               * 02920000
029300***************************************************************** 02930000
029400                                                                  02940000
029500 1000-START-PROCESS.                                              02950000
029600                                                                  02960000
029700     MOVE ZEROS TO ERRR-CD OF Z5058LK1.                           02970000
029800     MOVE SPACES TO ERRR-DA OF Z5058LK1.                          02980000
029900     MOVE ZEROS TO RTRN-CD OF Z5058LK1.                           02990000
030000     MOVE SPACES TO SQLCA-AR OF Z5058LK1.                         03000000
030100/                                                                 03010000
030200***************************************************************** 03020000
030300*                 2000 MAIN PROCESSING                          * 03030000
030400*                                                               * 03040000
030500*    THIS PARAGRAPH USE SELECT TO APA7 TO GET INFO OF BLOCK     * 03050000
030600*                                                               * 03060000
030700*    DB2V8 CHANGE (EMER #B4583822) :                            * 03070000
030800*    CHANGED CODE TO CALL XIRZ7200 TO CONNECT, RESET            * 03080000
030900*    AND TO DO  REMOTE ACCESS ON XIRZ056Y.                      * 03090000
031000*                                                               * 03100000
031100*    PARAGRAPHS CALLED: 3000-CALL-XIRZ7200                      * 03110000
031200*                                                               * 03120000
031300***************************************************************** 03130000
031400                                                                  03140000
031500 2000-MAIN-PROCESS.                                               03150000
031600                                                                  03160000
031700*    REMOTE CONNECTION LOGIC                                      03170000
031800     MOVE SPACES TO Z7200LK1                                      03180000
031900     MOVE WS-XIRZ056Y-VIEW TO VW-NM OF Z7200LK1.                  03190000
032000                                                                  03200000
032100     SET FUNC-CONNECT OF Z7200LK1 TO TRUE                         03210000
032200     PERFORM 3000-CALL-XIRZ7200                                   03220000
032300                                                                  03230000
032400     CALL LT-XIRDAZ58 USING DAZ58LK1                              03240000
032500                                                                  03250000
032600*    RESET REMOTE CONNECTION                                      03260000
032700     SET FUNC-RESET   OF Z7200LK1 TO TRUE                         03270000
032800     PERFORM 3000-CALL-XIRZ7200                                   03280000
032900                                                                  03290000
033000     IF RTRN-CD OF DAZ58LK1 = ZEROS                               03300000
033100           CONTINUE                                               03310000
033200     ELSE                                                         03320000
033300           MOVE RTRN-CD  OF DAZ58LK1 TO RTRN-CD  OF Z5058LK1      03330000
033400           MOVE SQLCA-AR OF DAZ58LK1 TO SQLCA-AR OF Z5058LK1      03340000
033500           PERFORM Z9000-CHECKOUT                                 03350000
033600     END-IF.                                                      03360000
033700                                                                  03370000
033800/                                                                 03380000
033900***************************************************************** 03390000
034000*                    3000-CALL-XIRZ7200                         * 03400000
034100*                                                               * 03410000
034200*  THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:             * 03420000
034300*                                                               * 03430000
034400*  1.  GET ALIAS REFERENCE AND SET THE DRDA CONNECTION OR CLOSE * 03440000
034500*      IT.                                                      * 03450000
034600*                                                               * 03460000
034700*    PARAGRAPHS CALLED: NONE.                                   * 03470000
034800*                                                               * 03480000
034900***************************************************************** 03490000
035000 3000-CALL-XIRZ7200.                                              03500000
035100                                                                  03510000
035200     MOVE SPLR-ID OF Z5058LK1 TO SPLR-ID OF Z7200LK1.             03520000
035300     MOVE WS-PROGRAM-NAME-LIT TO PROG-ID OF Z7200LK1.             03530000
035400                                                                  03540000
035500     CALL LT-XIRZ7200 USING Z7200LK1.                             03550000
035600                                                                  03560000
035700     EVALUATE RTRN-CD OF Z7200LK1                                 03570000
035800     WHEN ZEROS                                                   03580000
035900         CONTINUE                                                 03590000
036000                                                                  03600000
036100     WHEN OTHER                                                   03610000
036200         DISPLAY 'XIRZ5058 - BAD REMOTE CONNECTION'               03620000
036300         MOVE RTRN-CD OF Z7200LK1    TO RTRN-CD       OF Z5058LK1 03630000
036400         MOVE WS-ERROR-CALL-XIRZ7200 TO ERRR-DA       OF Z5058LK1 03640000
036500         MOVE SQLCA-AR OF Z7200LK1   TO SQLCA-AR      OF Z5058LK1 03650000
036600         PERFORM Z9000-CHECKOUT                                   03660000
036700     END-EVALUATE.                                                03670000
036800                                                                  03680000
036900 3000-EXIT.                                                       03690000
037000     EXIT.                                                        03700000
037100                                                                  03710000
037200                                                                  03720000
037300     EJECT                                                        03730000
037400***************************************************************** 03740000
037500*               4 0 0 0   S E A R C H    T A B L E              * 03750000
037600*                                                               * 03760000
037700* THIS PARAGRAPH PERFORMS SEARCH OF THE INTERNAL TABLE.         * 03770000
037800*                                                               * 03780000
037900***************************************************************** 03790000
038000 4000-SEARCH-TBL.                                                 03800000
038100                                                                  03810000
038200     SET XIRZ056Y-IDX TO 1.                                       03820000
038300                                                                  03830000
038400     SEARCH  WS-XIRZ056Y-CD                                       03840000
038500       AT END                                                     03850000
038600          CONTINUE                                                03860000
038700       WHEN WS-TYP-CD (XIRZ056Y-IDX) = WS-TYPE-CD                 03870000
038800       AND (WS-EDIT-KEY >= WS-LW-TEL-NO (XIRZ056Y-IDX)            03880000
038900       AND  WS-EDIT-KEY <= WS-HI-TEL-NO (XIRZ056Y-IDX))           03890000
039000            MOVE WS-ACCOUNT-BLOCK TO ERRR-CD OF Z5058LK1          03900000
039100     END-SEARCH.                                                  03910000
039200                                                                  03920000
039300     EJECT                                                        03930000
039400***************************************************************** 03940000
039500*               Z9000 CHECKOUT                                  * 03950000
039600*                                                               * 03960000
039700*    THIS PROCESS WILL RETURN CONTROL TO THE CALLING MODULE.    * 03970000
039800*                                                               * 03980000
039900***************************************************************** 03990000
040000                                                                  04000000
040100 Z9000-CHECKOUT.                                                  04010000
040200                                                                  04020000
040300     GOBACK.                                                      04030000
